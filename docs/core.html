---

title: core


keywords: fastai
sidebar: home_sidebar

summary: "The methods found in this package are useful when writing any python code and are intended to be part of the base packages imported for new projects.  "
description: "The methods found in this package are useful when writing any python code and are intended to be part of the base packages imported for new projects.  "
nb_path: "nbs/00_core.ipynb"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: nbs/00_core.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li><strong><em>validate_param</em></strong> : check user passed variables to ensure they meet set of requirements.  (<strong>FAST FAIL</strong> idealogy)</li>
<li><strong><em>documented_by</em></strong> : copy docstring a function, intended for wrapper functions and decorators.  (<strong>SINGLE SOURCE</strong> idealogy)</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<hr>
<p><strong>NOTES:</strong></p>
<p>This package comes with no warranty and no garantees.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="methods">methods<a class="anchor-link" href="#methods"> </a></h2>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="validate_param" class="doc_header"><code>validate_param</code><a href="https://github.com/MaxGunton/mval/tree/main/mval/core.py#L219" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>validate_param</code>(<strong><code>p</code></strong>, <strong><code>p_type</code></strong>, <strong><code>p_name</code></strong>, <strong><code>p_restrictions</code></strong>=<em><code>None</code></em>)</p>
</blockquote>
<p>This function check parameter <code>p</code> to ensure it is of type <code>p_type</code>.  <code>p_name</code> is the variable
name of <code>p</code> and is strictly used in error messages.  <code>p_restrictions</code> are the restrictions that
the <code>p</code> must meet.  If the parameter <code>p</code> is the correct type and fits the restrictions then it
is returned otherwise an exception is raised.</p>
<p><strong>Parameters</strong></p>
<p><code>p_type</code>: can be virtually any type with support for primative types and objects. More complex
nested structures can be expressed by importing the python typing module and using the typing
notation for example:
(List[str] represents a list of strings).</p>
<p><code>p_name</code>: should be a <code>str</code> matching the name of the variable.</p>
<p><code>p_restrictions</code>: can be any of the following:</p>

<pre><code>  - None (no restriction)
  - set of allowed values
      ex. {1, 33, 44}
  - bounds expression (for int and float values only)
      ex. [1,)   means 1 &lt;= p &lt; infinity
          [0,10] means 0 &lt;= p &lt;= 10
          (,10)  means -infinity &lt; p &lt; 10
  - function returning True if satisfies restriction and False otherwise
      ex.
          os.path.isfile
  - lambda expression

</code></pre>
<p>The bounds restriction and set of allowed values are intended to make readability easier for the user, but <strong><em>ANY</em></strong>
restriction can be represented as a function and this allows for more complex restrictions to be represented.</p>
<p><strong>Return</strong></p>
<p>If parameter is valid than it is returned unchanged, otherwise an exception is raised.</p>
<p><strong>Limitations</strong></p>
<ul>
<li>Only supports the following from typing module: List, Tuple, Dict, and Union</li>
<li>Only supports Tuple definitions of fixed size (i.e. Tuple[int, float, str] and not Tuple[int, ...])</li>
<li><p>Restrictions are applied to entire value i.e. not nested values. For example:</p>
<p><strong><em>Given:</em></strong> <code>validate_param(p, Tuple[str, str, str], "p", {"A", "B", "C"})</code></p>
<p>The user may intend for the inner values of the tuple to be "A", "B" or "C", but instead this will restrict <code>p</code> as a
  whole to being "A", "B", or "C".  If we use the following lambda expression as the restriction we can get the desired
  functionality:</p>
<p><strong><em>Instead Use:</em></strong> <code>validate_param(p, Tuple[str, str, str], "p", lambda x: all([True if i in {"A", "B", "C"} else
  False for i in x]))</code></p>
</li>
</ul>
<p><strong>Examples</strong></p>
<div class="highlight"><pre><span></span><span class="c1"># example 1</span>
<span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">Union</span><span class="p">,</span> <span class="n">Tuple</span>

<span class="n">p</span> <span class="o">=</span> <span class="n">validate_param</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">Union</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">]],</span> <span class="s2">&quot;p&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
</pre></div>
<p>This indicates that the type must be an int, float or 3 element tuple with the first two values being strings and the
last a pandas DataFrame.</p>
<div class="highlight"><pre><span></span><span class="c1"># example 2</span>
<span class="n">p</span> <span class="o">=</span> <span class="n">validate_param</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="s2">&quot;p&quot;</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="ow">and</span> <span class="n">x</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">&quot;.wav&quot;</span><span class="p">))</span>
</pre></div>
<p>This indicates that the p must be a str representing a file ending in .wav.  Also note the use of lambda expressions as
the p_restriction.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="validate_and_load" class="doc_header"><code>validate_and_load</code><a href="https://github.com/MaxGunton/mval/tree/main/mval/core.py#L300" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>validate_and_load</code>(<strong><code>params</code></strong>, <strong><code>defs</code></strong>)</p>
</blockquote>
<p>Check a set of parameters stored in the <code>param</code> dictionary to see if they meet the necessary requirements of
<code>definitions</code>.  If they do, they are loaded and returned in the order supplied within dictionary,
otherwise raise an exception.</p>
<p><strong>Parameters</strong></p>
<ul>
<li><code>param</code>: <em>Dict[str, Any]</em>: Keys of params must be present in <code>mtemplate.definitions.PARAMS</code> and identify which
<pre><code>                       parameter it is, and its value is the value we are validating and loading.</code></pre>
</li>
<li><code>defs</code>: <em>Dict[str,Tuple[type, function, function]]</em>: contains the type, restrictions function, and loading function
<pre><code>                                                 for each parameter
</code></pre>
<strong>Returns</strong></li>
<li><em>tuple</em>: containing the validated and loaded parameters (in the same order as the params dictionary).</li>
</ul>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="ParameterNotDefinedError" class="doc_header"><code>class</code> <code>ParameterNotDefinedError</code><a href="https://github.com/MaxGunton/mval/tree/main/mval/core.py#L328" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>ParameterNotDefinedError</code>(<strong><code>value</code></strong>=<em><code>None</code></em>) :: <code>Exception</code></p>
</blockquote>
<p>This exception is raised when a p_name is not a key in the <code>defs</code> dictionary.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="documented_by" class="doc_header"><code>documented_by</code><a href="https://github.com/MaxGunton/mval/tree/main/mval/core.py#L339" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>documented_by</code>(<strong><code>original_doc_func</code></strong>)</p>
</blockquote>
<p>This decorator function allows functions to copy docstrings from other functions.  And appends any docstring it has to the
end.</p>
<p><strong>Parameters</strong></p>
<ul>
<li><code>original_doc_func</code>: function from which to copy docstring</li>
</ul>
<p><strong>Returns</strong></p>
<ul>
<li><code>&lt;class 'function'&gt;</code>: that copies the doc string of one function to another.</li>
</ul>
<p><strong>Examples</strong></p>
<div class="highlight"><pre><span></span><span class="c1"># example 1</span>
<span class="nd">@documented_by</span><span class="p">(</span><span class="n">original_doc_string</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">has_copied_docstring</span><span class="p">():</span>
    <span class="k">pass</span>
</pre></div>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

</div>
 

